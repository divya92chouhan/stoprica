#raceResults
  .mdl-grid.is-heading
    .mdl-cell.mdl-cell--1-col Mjesto
    - if @race.league&.xczld? || @race.league&.running? || @race.league&.trail?
      .mdl-cell.mdl-cell--1-col Bodovi
    .mdl-cell.mdl-cell--1-col Startni broj
    / .mdl-cell{ class: "mdl-cell--#{@race.league&.xczld? ? 1 : 2}-col" }
    /   - if @race.uci_display?
    /     UCI ID
    .mdl-cell.mdl-cell--3-col.mdl-cell--2-col-phone Ime i Prezime
    .mdl-cell.mdl-cell--2-col.mdl-cell--2-col-phone Klub
    .mdl-cell.mdl-cell--1-col Status
    - unless @race.laps.nil?
      - (1..@race.laps).each do |lap|
        .mdl-cell.mdl-cell--1-col= "KT #{lap}"
    .mdl-cell.mdl-cell--1-col Vrijeme
    .mdl-cell.mdl-cell--1-col Zaostatak

  - if params[:absolute]
    - @race.race_results.sort_by{ |rr| [rr.missed_control_points, -rr.lap_times.length, rr.finish_time] }.each_with_index do |race_result, index|
      = render 'result', race_result: race_result, index: index

  - else
    - @race.categories.order(id: :asc).each_with_index do |category, index|
      .mdl-grid{ class: "cat-#{index}", onclick: "collapse('#collapse-#{category.id}', event)" }
        .mdl-cell.mdl-cell--12-col.collapse-trigger
          = category.name.upcase
          %b= "(#{@sorted_results[category].size})"

          %i.material-icons.down.is-pulled-right expand_more
          %i.material-icons.up.is-pulled-right expand_less

          - if category.track_elevation
            %span.is-pulled-right
              %i.material-icons landscape
              = category.track_elevation
              m

          - if category.track_length
            %span.is-pulled-right
              %i.material-icons navigation
              = (category.track_length.to_f/1000).round 1
              km &nbsp;

      .collapse{ id: "collapse-#{category.id}" }
        - @sorted_results[category].each_with_index do |race_result, index|
          = render 'result', race_result: race_result, index: index


:javascript
  function collapse(selector, e) {
    var el = document.querySelector(selector);
    el.classList.toggle('collapsed');
    e.target.classList.toggle('collapsed');
  }
